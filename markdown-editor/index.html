<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MarkFlow — Free Live Markdown Editor &amp; Preview Online</title>
    <meta name="description" content="Free online Markdown editor with live preview. Syntax highlighting, toolbar, export to HTML. No sign-up required. Beautiful dark theme.">
    <meta name="keywords" content="markdown editor online, markdown preview, markdown to html, live markdown editor, free markdown tool">
    <link rel="canonical" href="https://christian140903-sudo.github.io/devtoolkit/markdown-editor/">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="MarkFlow — Free Live Markdown Editor &amp; Preview">
    <meta property="og:description" content="Write Markdown with live preview, syntax highlighting, toolbar, and export options. Free and beautiful.">
    <meta property="og:url" content="https://christian140903-sudo.github.io/devtoolkit/markdown-editor/">
    <meta property="og:site_name" content="NexTool DevToolkit">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="MarkFlow — Free Live Markdown Editor">
    <meta name="twitter:description" content="Write Markdown with live preview, syntax highlighting, toolbar, and export options.">

    <!-- Schema.org -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "MarkFlow — Live Markdown Editor",
        "description": "Free online Markdown editor with live preview, syntax highlighting, toolbar, and export to HTML.",
        "url": "https://christian140903-sudo.github.io/devtoolkit/markdown-editor/",
        "applicationCategory": "DeveloperApplication",
        "operatingSystem": "Any",
        "offers": { "@type": "Offer", "price": "0", "priceCurrency": "USD" },
        "author": { "@type": "Organization", "name": "NexTool", "url": "https://nextool.app" }
    }
    </script>

    <!-- Analytics Placeholder -->
    <!-- GA: Replace G-PLACEHOLDER with real GA4 ID --><!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-PLACEHOLDER"></script> -->
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-PLACEHOLDER');</script>

    <style>
        *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --bg: #0a0a0a;
            --card: #141414;
            --border: #222222;
            --text: #e5e5e5;
            --text-muted: #888888;
            --accent: #6366f1;
            --accent-hover: #818cf8;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --radius-card: 12px;
            --radius-input: 8px;
            --transition: 0.2s ease;
            --editor-bg: #0d0d0d;
        }

        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Header */
        .header {
            border-bottom: 1px solid var(--border);
            padding: 12px 0;
            flex-shrink: 0;
        }

        .header-inner {
            max-width: 100%;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
            color: var(--text);
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--accent), #a855f7);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 14px;
            color: white;
        }

        .logo-text { font-size: 18px; font-weight: 700; letter-spacing: -0.02em; }
        .logo-text span { color: var(--accent); }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .header-btn {
            background: var(--card);
            border: 1px solid var(--border);
            color: var(--text-muted);
            padding: 7px 14px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: all var(--transition);
            font-family: inherit;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .header-btn:hover { border-color: var(--accent); color: var(--text); }
        .header-btn.accent { background: var(--accent); border-color: var(--accent); color: white; }
        .header-btn.accent:hover { background: var(--accent-hover); }

        /* Toolbar */
        .toolbar {
            border-bottom: 1px solid var(--border);
            padding: 8px 20px;
            display: flex;
            align-items: center;
            gap: 4px;
            flex-shrink: 0;
            flex-wrap: wrap;
            background: var(--card);
        }

        .toolbar-btn {
            background: transparent;
            border: 1px solid transparent;
            color: var(--text-muted);
            padding: 6px 10px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            transition: all var(--transition);
            font-family: 'SF Mono', 'Fira Code', monospace;
            min-width: 32px;
            text-align: center;
        }

        .toolbar-btn:hover { background: var(--border); color: var(--text); }
        .toolbar-btn:active { background: var(--accent); color: white; }

        .toolbar-sep {
            width: 1px;
            height: 20px;
            background: var(--border);
            margin: 0 6px;
        }

        /* Main Editor Area */
        .editor-container {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        .editor-pane, .preview-pane {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        .editor-pane {
            border-right: 1px solid var(--border);
        }

        .pane-header {
            padding: 8px 16px;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: var(--text-muted);
            border-bottom: 1px solid var(--border);
            background: var(--card);
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
        }

        .fullscreen-btn {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 14px;
            padding: 2px 6px;
            border-radius: 4px;
            transition: all var(--transition);
        }

        .fullscreen-btn:hover { color: var(--text); background: var(--border); }

        /* Editor textarea */
        .editor-textarea {
            flex: 1;
            width: 100%;
            padding: 20px;
            background: var(--editor-bg);
            border: none;
            color: var(--text);
            font-family: 'SF Mono', 'Fira Code', 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            line-height: 1.7;
            resize: none;
            outline: none;
            tab-size: 2;
            overflow-y: auto;
        }

        .editor-textarea::placeholder { color: #444; }

        /* Preview */
        .preview-content {
            flex: 1;
            padding: 24px;
            overflow-y: auto;
            background: var(--bg);
        }

        /* Markdown rendered styles */
        .preview-content h1 {
            font-size: 32px;
            font-weight: 800;
            letter-spacing: -0.03em;
            margin-bottom: 16px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border);
            color: var(--text);
        }

        .preview-content h2 {
            font-size: 24px;
            font-weight: 700;
            letter-spacing: -0.02em;
            margin-top: 32px;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border);
            color: var(--text);
        }

        .preview-content h3 {
            font-size: 20px;
            font-weight: 700;
            margin-top: 24px;
            margin-bottom: 10px;
            color: var(--text);
        }

        .preview-content h4 {
            font-size: 16px;
            font-weight: 700;
            margin-top: 20px;
            margin-bottom: 8px;
            color: var(--text);
        }

        .preview-content p {
            margin-bottom: 14px;
            line-height: 1.7;
            color: #ccc;
        }

        .preview-content a {
            color: var(--accent);
            text-decoration: none;
        }

        .preview-content a:hover { text-decoration: underline; }

        .preview-content strong { font-weight: 700; color: var(--text); }
        .preview-content em { font-style: italic; }

        .preview-content code {
            font-family: 'SF Mono', 'Fira Code', monospace;
            background: var(--card);
            border: 1px solid var(--border);
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 13px;
            color: #f472b6;
        }

        .preview-content pre {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: var(--radius-input);
            padding: 16px;
            overflow-x: auto;
            margin-bottom: 16px;
        }

        .preview-content pre code {
            background: none;
            border: none;
            padding: 0;
            color: var(--text);
            font-size: 13px;
            line-height: 1.6;
        }

        .preview-content blockquote {
            border-left: 3px solid var(--accent);
            padding: 8px 16px;
            margin: 0 0 16px;
            color: var(--text-muted);
            background: var(--card);
            border-radius: 0 var(--radius-input) var(--radius-input) 0;
        }

        .preview-content blockquote p { margin-bottom: 0; color: inherit; }

        .preview-content ul, .preview-content ol {
            margin-bottom: 14px;
            padding-left: 24px;
            color: #ccc;
        }

        .preview-content li { margin-bottom: 4px; }

        .preview-content hr {
            border: none;
            border-top: 1px solid var(--border);
            margin: 24px 0;
        }

        .preview-content img {
            max-width: 100%;
            border-radius: var(--radius-input);
            margin: 8px 0;
        }

        .preview-content table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 16px;
        }

        .preview-content th, .preview-content td {
            border: 1px solid var(--border);
            padding: 8px 12px;
            text-align: left;
            font-size: 14px;
        }

        .preview-content th {
            background: var(--card);
            font-weight: 600;
            color: var(--text);
        }

        .preview-content td { color: #ccc; }

        /* Status Bar */
        .status-bar {
            border-top: 1px solid var(--border);
            padding: 6px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 12px;
            color: var(--text-muted);
            background: var(--card);
            flex-shrink: 0;
        }

        .status-left, .status-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--success);
            display: inline-block;
            margin-right: 4px;
        }

        /* Fullscreen */
        .editor-pane.fullscreen, .preview-pane.fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 100;
            border: none;
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 24px;
            right: 24px;
            background: var(--card);
            border: 1px solid var(--border);
            padding: 14px 24px;
            border-radius: var(--radius-input);
            font-size: 14px;
            color: var(--text);
            z-index: 1000;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s ease;
            pointer-events: none;
        }

        .toast.show { opacity: 1; transform: translateY(0); }

        /* Footer */
        .footer {
            border-top: 1px solid var(--border);
            padding: 10px 20px;
            text-align: center;
            color: var(--text-muted);
            font-size: 12px;
            flex-shrink: 0;
            background: var(--card);
        }

        .footer a { color: var(--accent); text-decoration: none; }
        .footer a:hover { text-decoration: underline; }

        /* Responsive */
        @media (max-width: 768px) {
            .editor-container { flex-direction: column; }
            .editor-pane { border-right: none; border-bottom: 1px solid var(--border); }
            .editor-pane, .preview-pane { min-height: 40vh; }
            .header-actions { flex-wrap: wrap; }
            .toolbar { overflow-x: auto; flex-wrap: nowrap; }
        }

        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg); }
        ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #333; }
    </style>
</head>
<body>

<header class="header">
    <div class="header-inner">
        <div class="header-left">
            <a href="https://nextool.app" class="logo" aria-label="NexTool Home">
                <div class="logo-icon">M</div>
                <div class="logo-text">Mark<span>Flow</span></div>
            </a>
        </div>
        <div class="header-actions">
            <button class="header-btn" onclick="loadSample()" title="Load sample markdown">Sample</button>
            <button class="header-btn" onclick="clearEditor()" title="Clear editor">Clear</button>
            <button class="header-btn" onclick="exportMarkdown()" title="Download as .md file">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                .md
            </button>
            <button class="header-btn" onclick="exportHtml()" title="Export as HTML">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                HTML
            </button>
            <button class="header-btn accent" onclick="copyRenderedHtml()" title="Copy rendered HTML to clipboard">Copy HTML</button>
        </div>
    </div>
</header>

<div class="toolbar" role="toolbar" aria-label="Markdown formatting toolbar">
    <button class="toolbar-btn" onclick="insertFormat('heading1')" title="Heading 1">H1</button>
    <button class="toolbar-btn" onclick="insertFormat('heading2')" title="Heading 2">H2</button>
    <button class="toolbar-btn" onclick="insertFormat('heading3')" title="Heading 3">H3</button>
    <div class="toolbar-sep"></div>
    <button class="toolbar-btn" onclick="insertFormat('bold')" title="Bold (Ctrl+B)"><strong>B</strong></button>
    <button class="toolbar-btn" onclick="insertFormat('italic')" title="Italic (Ctrl+I)"><em>I</em></button>
    <button class="toolbar-btn" onclick="insertFormat('strikethrough')" title="Strikethrough"><s>S</s></button>
    <div class="toolbar-sep"></div>
    <button class="toolbar-btn" onclick="insertFormat('link')" title="Link">&#128279;</button>
    <button class="toolbar-btn" onclick="insertFormat('image')" title="Image">&#128247;</button>
    <button class="toolbar-btn" onclick="insertFormat('code')" title="Inline Code">&lt;/&gt;</button>
    <button class="toolbar-btn" onclick="insertFormat('codeblock')" title="Code Block">{ }</button>
    <div class="toolbar-sep"></div>
    <button class="toolbar-btn" onclick="insertFormat('ul')" title="Unordered List">&#8226; List</button>
    <button class="toolbar-btn" onclick="insertFormat('ol')" title="Ordered List">1. List</button>
    <button class="toolbar-btn" onclick="insertFormat('quote')" title="Blockquote">&gt; Quote</button>
    <button class="toolbar-btn" onclick="insertFormat('hr')" title="Horizontal Rule">&#8212;</button>
    <button class="toolbar-btn" onclick="insertFormat('table')" title="Table">Table</button>
</div>

<div class="editor-container">
    <div class="editor-pane" id="editorPane">
        <div class="pane-header">
            <span>Editor</span>
            <button class="fullscreen-btn" onclick="toggleFullscreen('editor')" title="Toggle fullscreen">&#9634;</button>
        </div>
        <textarea class="editor-textarea" id="editor" placeholder="Start writing Markdown here..." spellcheck="false"></textarea>
    </div>

    <div class="preview-pane" id="previewPane">
        <div class="pane-header">
            <span>Preview</span>
            <button class="fullscreen-btn" onclick="toggleFullscreen('preview')" title="Toggle fullscreen">&#9634;</button>
        </div>
        <div class="preview-content" id="preview"></div>
    </div>
</div>

<div class="status-bar">
    <div class="status-left">
        <span><span class="status-dot"></span>Auto-saved</span>
        <span id="statusWords">0 words</span>
        <span id="statusChars">0 characters</span>
        <span id="statusLines">0 lines</span>
    </div>
    <div class="status-right">
        <span>Markdown</span>
    </div>
</div>

<footer class="footer">
    Part of <a href="https://christian140903-sudo.github.io/devtoolkit/">DevToolkit</a> by <a href="https://nextool.app">NexTool</a> &middot; nextool.app
</footer>

<div class="toast" id="toast"></div>

<script>
    const editor = document.getElementById('editor');
    const preview = document.getElementById('preview');
    let debounceTimer;
    let autoSaveTimer;

    // --- Editor Events ---
    editor.addEventListener('input', () => {
        clearTimeout(debounceTimer);
        debounceTimer = setTimeout(() => {
            renderPreview();
            updateStatus();
        }, 100);

        clearTimeout(autoSaveTimer);
        autoSaveTimer = setTimeout(autoSave, 1000);
    });

    editor.addEventListener('keydown', (e) => {
        // Tab handling
        if (e.key === 'Tab') {
            e.preventDefault();
            const start = editor.selectionStart;
            const end = editor.selectionEnd;
            editor.value = editor.value.substring(0, start) + '  ' + editor.value.substring(end);
            editor.selectionStart = editor.selectionEnd = start + 2;
            renderPreview();
        }

        // Keyboard shortcuts
        if (e.ctrlKey || e.metaKey) {
            if (e.key === 'b') { e.preventDefault(); insertFormat('bold'); }
            if (e.key === 'i') { e.preventDefault(); insertFormat('italic'); }
            if (e.key === 'k') { e.preventDefault(); insertFormat('link'); }
        }
    });

    // --- Markdown Parser ---
    function parseMarkdown(md) {
        let html = md;

        // Escape HTML (except what we generate)
        html = html.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');

        // Code blocks (fenced)
        html = html.replace(/```(\w*)\n([\s\S]*?)```/g, (m, lang, code) => {
            return '<pre><code>' + code.trim() + '</code></pre>';
        });

        // Inline code
        html = html.replace(/`([^`]+)`/g, '<code>$1</code>');

        // Images
        html = html.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, '<img src="$2" alt="$1">');

        // Links
        html = html.replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2" target="_blank" rel="noopener">$1</a>');

        // Headings
        html = html.replace(/^#### (.+)$/gm, '<h4>$1</h4>');
        html = html.replace(/^### (.+)$/gm, '<h3>$1</h3>');
        html = html.replace(/^## (.+)$/gm, '<h2>$1</h2>');
        html = html.replace(/^# (.+)$/gm, '<h1>$1</h1>');

        // Horizontal rule
        html = html.replace(/^---+$/gm, '<hr>');
        html = html.replace(/^\*\*\*+$/gm, '<hr>');

        // Bold + Italic
        html = html.replace(/\*\*\*(.+?)\*\*\*/g, '<strong><em>$1</em></strong>');
        // Bold
        html = html.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>');
        html = html.replace(/__(.+?)__/g, '<strong>$1</strong>');
        // Italic
        html = html.replace(/\*(.+?)\*/g, '<em>$1</em>');
        html = html.replace(/_(.+?)_/g, '<em>$1</em>');
        // Strikethrough
        html = html.replace(/~~(.+?)~~/g, '<del>$1</del>');

        // Blockquotes
        html = html.replace(/^&gt; (.+)$/gm, '<blockquote><p>$1</p></blockquote>');
        // Merge consecutive blockquotes
        html = html.replace(/<\/blockquote>\n<blockquote>/g, '\n');

        // Tables
        html = html.replace(/^(\|.+\|)\n(\|[-| :]+\|)\n((?:\|.+\|\n?)+)/gm, (match, header, sep, body) => {
            const headers = header.split('|').filter(c => c.trim()).map(c => `<th>${c.trim()}</th>`).join('');
            const rows = body.trim().split('\n').map(row => {
                const cells = row.split('|').filter(c => c.trim()).map(c => `<td>${c.trim()}</td>`).join('');
                return `<tr>${cells}</tr>`;
            }).join('');
            return `<table><thead><tr>${headers}</tr></thead><tbody>${rows}</tbody></table>`;
        });

        // Unordered lists
        html = html.replace(/^[\*\-] (.+)$/gm, '<li>$1</li>');
        html = html.replace(/((?:<li>.*<\/li>\n?)+)/g, (m) => {
            if (m.includes('<ol>')) return m;
            return '<ul>' + m + '</ul>';
        });

        // Ordered lists
        html = html.replace(/^\d+\. (.+)$/gm, '<li>$1</li>');
        // Wrap consecutive <li> not already in <ul> or <ol>
        html = html.replace(/(<li>.*<\/li>\n?)+/g, (m) => {
            if (m.startsWith('<ul>') || m.startsWith('<ol>')) return m;
            return '<ul>' + m + '</ul>';
        });

        // Paragraphs - handle blocks of text separated by blank lines
        const blocks = html.split(/\n\n+/);
        html = blocks.map(block => {
            block = block.trim();
            if (!block) return '';
            // Don't wrap block-level elements
            if (/^<(h[1-6]|ul|ol|li|pre|blockquote|table|hr|img|div)/.test(block)) {
                return block;
            }
            // Wrap in paragraph, converting single newlines to <br>
            return '<p>' + block.replace(/\n/g, '<br>') + '</p>';
        }).join('\n');

        return html;
    }

    function renderPreview() {
        const md = editor.value;
        preview.innerHTML = parseMarkdown(md);
    }

    function updateStatus() {
        const text = editor.value;
        const words = text.trim() ? text.trim().split(/\s+/).length : 0;
        const chars = text.length;
        const lines = text.split('\n').length;

        document.getElementById('statusWords').textContent = words + ' word' + (words !== 1 ? 's' : '');
        document.getElementById('statusChars').textContent = chars + ' character' + (chars !== 1 ? 's' : '');
        document.getElementById('statusLines').textContent = lines + ' line' + (lines !== 1 ? 's' : '');
    }

    // --- Toolbar ---
    function insertFormat(type) {
        const start = editor.selectionStart;
        const end = editor.selectionEnd;
        const selected = editor.value.substring(start, end);
        let before = '', after = '', replacement = '';

        switch (type) {
            case 'heading1':
                replacement = '# ' + (selected || 'Heading 1');
                break;
            case 'heading2':
                replacement = '## ' + (selected || 'Heading 2');
                break;
            case 'heading3':
                replacement = '### ' + (selected || 'Heading 3');
                break;
            case 'bold':
                replacement = '**' + (selected || 'bold text') + '**';
                break;
            case 'italic':
                replacement = '*' + (selected || 'italic text') + '*';
                break;
            case 'strikethrough':
                replacement = '~~' + (selected || 'strikethrough') + '~~';
                break;
            case 'link':
                replacement = '[' + (selected || 'link text') + '](https://example.com)';
                break;
            case 'image':
                replacement = '![' + (selected || 'alt text') + '](https://example.com/image.jpg)';
                break;
            case 'code':
                replacement = '`' + (selected || 'code') + '`';
                break;
            case 'codeblock':
                replacement = '```\n' + (selected || 'code here') + '\n```';
                break;
            case 'ul':
                replacement = '- ' + (selected || 'List item');
                break;
            case 'ol':
                replacement = '1. ' + (selected || 'List item');
                break;
            case 'quote':
                replacement = '> ' + (selected || 'Blockquote');
                break;
            case 'hr':
                replacement = '\n---\n';
                break;
            case 'table':
                replacement = '| Header 1 | Header 2 | Header 3 |\n| -------- | -------- | -------- |\n| Cell 1   | Cell 2   | Cell 3   |\n| Cell 4   | Cell 5   | Cell 6   |';
                break;
        }

        editor.value = editor.value.substring(0, start) + replacement + editor.value.substring(end);
        editor.focus();
        editor.selectionStart = start;
        editor.selectionEnd = start + replacement.length;
        renderPreview();
        updateStatus();
    }

    // --- Export ---
    function exportMarkdown() {
        const blob = new Blob([editor.value], { type: 'text/markdown' });
        downloadBlob(blob, 'document.md');
        showToast('Markdown file downloaded');
    }

    function exportHtml() {
        const html = `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        body { font-family: system-ui, sans-serif; max-width: 800px; margin: 40px auto; padding: 0 20px; line-height: 1.6; color: #333; }
        pre { background: #f5f5f5; padding: 16px; border-radius: 8px; overflow-x: auto; }
        code { background: #f0f0f0; padding: 2px 6px; border-radius: 4px; font-size: 0.9em; }
        pre code { background: none; padding: 0; }
        blockquote { border-left: 3px solid #6366f1; padding: 8px 16px; margin: 0 0 16px; color: #666; }
        table { border-collapse: collapse; width: 100%; margin-bottom: 16px; }
        th, td { border: 1px solid #ddd; padding: 8px 12px; text-align: left; }
        th { background: #f5f5f5; }
        img { max-width: 100%; }
        hr { border: none; border-top: 1px solid #eee; margin: 24px 0; }
    </style>
</head>
<body>
${preview.innerHTML}
</body>
</html>`;
        const blob = new Blob([html], { type: 'text/html' });
        downloadBlob(blob, 'document.html');
        showToast('HTML file downloaded');
    }

    function copyRenderedHtml() {
        navigator.clipboard.writeText(preview.innerHTML).then(() => {
            showToast('HTML copied to clipboard');
        });
    }

    function downloadBlob(blob, name) {
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = name;
        a.click();
        URL.revokeObjectURL(url);
    }

    // --- Auto-save ---
    function autoSave() {
        localStorage.setItem('markflow-content', editor.value);
    }

    function loadSaved() {
        const saved = localStorage.getItem('markflow-content');
        if (saved) {
            editor.value = saved;
            renderPreview();
            updateStatus();
        }
    }

    // --- Fullscreen ---
    function toggleFullscreen(pane) {
        const el = pane === 'editor' ? document.getElementById('editorPane') : document.getElementById('previewPane');
        el.classList.toggle('fullscreen');
    }

    // --- Sample Content ---
    function loadSample() {
        editor.value = `# Welcome to MarkFlow

A **beautiful** Markdown editor with *live preview*, built for developers who value simplicity and speed.

## Features

- **Live preview** — See your Markdown rendered instantly
- **Syntax support** — Full Markdown with tables, code blocks, and more
- **Export options** — Download as \`.md\` or \`.html\`
- **Auto-save** — Your work is saved to localStorage

## Code Example

\`\`\`javascript
function greet(name) {
  return \`Hello, \${name}!\`;
}

console.log(greet("World"));
\`\`\`

You can also use \`inline code\` anywhere in your text.

## Tables

| Feature      | Status  | Notes              |
| ------------ | ------- | ------------------ |
| Live Preview | Done    | Updates in 100ms   |
| Export HTML   | Done    | Clean, styled HTML |
| Auto-save    | Done    | Uses localStorage  |
| Dark Theme   | Done    | Easy on the eyes   |

## Blockquote

> "The best way to predict the future is to invent it."
> — Alan Kay

## Links & Images

Visit [NexTool](https://nextool.app) for more developer tools.

---

### Getting Started

1. Start typing in the editor on the left
2. See the live preview on the right
3. Use the toolbar for quick formatting
4. Export when you're done

**Happy writing!**`;
        renderPreview();
        updateStatus();
        autoSave();
    }

    function clearEditor() {
        editor.value = '';
        renderPreview();
        updateStatus();
        autoSave();
        editor.focus();
    }

    // --- Toast ---
    function showToast(msg) {
        const toast = document.getElementById('toast');
        toast.textContent = msg;
        toast.classList.add('show');
        setTimeout(() => toast.classList.remove('show'), 2500);
    }

    // --- Init ---
    loadSaved();
    if (!editor.value) {
        loadSample();
    } else {
        renderPreview();
        updateStatus();
    }
</script>
</body>
</html>