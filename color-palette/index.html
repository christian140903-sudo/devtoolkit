<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChromaKit — Free AI Color Palette Generator &amp; Color Scheme Tool</title>
    <meta name="description" content="Generate beautiful color palettes with color theory modes. Export as CSS, Tailwind, SCSS. Check WCAG contrast. Free online color scheme generator.">
    <meta name="keywords" content="color palette generator, color scheme generator, color theory, WCAG contrast checker, CSS color variables, tailwind colors">
    <link rel="canonical" href="https://christian140903-sudo.github.io/devtoolkit/color-palette/">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="ChromaKit — Free AI Color Palette Generator">
    <meta property="og:description" content="Generate harmonious color palettes. Export as CSS, Tailwind, SCSS. Check WCAG contrast ratios.">
    <meta property="og:url" content="https://christian140903-sudo.github.io/devtoolkit/color-palette/">
    <meta property="og:site_name" content="NexTool DevToolkit">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ChromaKit — Free AI Color Palette Generator">
    <meta name="twitter:description" content="Generate harmonious color palettes. Export as CSS, Tailwind, SCSS. Check WCAG contrast ratios.">

    <!-- Schema.org -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "ChromaKit — AI Color Palette Generator",
        "description": "Generate harmonious color palettes with color theory. Export as CSS, Tailwind, SCSS. WCAG contrast checker.",
        "url": "https://christian140903-sudo.github.io/devtoolkit/color-palette/",
        "applicationCategory": "DesignApplication",
        "operatingSystem": "Any",
        "offers": { "@type": "Offer", "price": "0", "priceCurrency": "USD" },
        "author": { "@type": "Organization", "name": "NexTool", "url": "https://nextool.app" }
    }
    </script>

    <!-- Analytics Placeholder -->
    <!-- GA: Replace G-PLACEHOLDER with real GA4 ID --><!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-PLACEHOLDER"></script> -->
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-PLACEHOLDER');</script>

    <style>
        *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --bg: #0a0a0a;
            --card: #141414;
            --border: #222222;
            --text: #e5e5e5;
            --text-muted: #888888;
            --accent: #6366f1;
            --accent-hover: #818cf8;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --radius-card: 12px;
            --radius-input: 8px;
            --transition: 0.2s ease;
        }

        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            border-bottom: 1px solid var(--border);
            padding: 20px 0;
        }

        .header-inner {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            color: var(--text);
        }

        .logo-icon {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, #ec4899, #8b5cf6, #3b82f6);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 16px;
            color: white;
        }

        .logo-text {
            font-size: 20px;
            font-weight: 700;
            letter-spacing: -0.02em;
        }

        .logo-text span { color: var(--accent); }

        .badge {
            background: var(--card);
            border: 1px solid var(--border);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 13px;
            color: var(--text-muted);
        }

        .main {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 24px;
            width: 100%;
            flex: 1;
        }

        .hero {
            text-align: center;
            margin-bottom: 32px;
        }

        .hero h1 {
            font-size: 36px;
            font-weight: 800;
            letter-spacing: -0.03em;
            margin-bottom: 12px;
            background: linear-gradient(135deg, #ec4899, #8b5cf6, #3b82f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero p {
            color: var(--text-muted);
            font-size: 16px;
            max-width: 560px;
            margin: 0 auto;
        }

        .shortcut-hint {
            display: inline-block;
            margin-top: 10px;
            background: var(--card);
            border: 1px solid var(--border);
            padding: 6px 14px;
            border-radius: 6px;
            font-size: 13px;
            color: var(--text-muted);
        }

        .shortcut-hint kbd {
            background: var(--border);
            padding: 2px 8px;
            border-radius: 4px;
            font-family: inherit;
            font-size: 12px;
            color: var(--text);
        }

        /* Controls */
        .controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 32px;
            flex-wrap: wrap;
        }

        .mode-btn {
            background: var(--card);
            border: 1px solid var(--border);
            color: var(--text-muted);
            padding: 8px 18px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: all var(--transition);
            font-family: inherit;
        }

        .mode-btn:hover { border-color: var(--accent); color: var(--text); }
        .mode-btn.active { background: var(--accent); border-color: var(--accent); color: white; }

        .generate-btn {
            background: var(--accent);
            border: none;
            color: white;
            padding: 10px 24px;
            border-radius: var(--radius-input);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition);
            font-family: inherit;
        }

        .generate-btn:hover { background: var(--accent-hover); transform: translateY(-1px); }

        /* Palette Display */
        .palette-container {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 12px;
            margin-bottom: 32px;
        }

        @media (max-width: 640px) {
            .palette-container { grid-template-columns: repeat(5, 1fr); gap: 6px; }
        }

        .color-swatch {
            border-radius: var(--radius-card);
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
        }

        .color-swatch:hover { transform: translateY(-4px); }
        .color-swatch.locked { border-color: white; }

        .swatch-color {
            height: 160px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        @media (max-width: 640px) {
            .swatch-color { height: 100px; }
        }

        .lock-icon {
            width: 28px;
            height: 28px;
            background: rgba(0,0,0,0.4);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity var(--transition);
            color: white;
            font-size: 14px;
        }

        .color-swatch:hover .lock-icon,
        .color-swatch.locked .lock-icon { opacity: 1; }

        .swatch-info {
            background: var(--card);
            padding: 12px;
            border-top: 1px solid var(--border);
        }

        .swatch-hex {
            font-weight: 700;
            font-size: 14px;
            letter-spacing: 0.02em;
            margin-bottom: 4px;
        }

        .swatch-formats {
            font-size: 11px;
            color: var(--text-muted);
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .swatch-copy {
            font-size: 11px;
            color: var(--accent);
            cursor: pointer;
            margin-top: 4px;
            background: none;
            border: none;
            font-family: inherit;
            padding: 0;
            text-align: left;
        }

        .swatch-copy:hover { color: var(--accent-hover); }

        /* Preview Card */
        .section-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 16px;
            letter-spacing: -0.01em;
        }

        .preview-section {
            margin-bottom: 32px;
        }

        .preview-card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: var(--radius-card);
            overflow: hidden;
            max-width: 500px;
            margin: 0 auto;
        }

        .preview-card-header {
            padding: 20px 24px;
            color: white;
        }

        .preview-card-header h4 {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .preview-card-header p {
            font-size: 13px;
            opacity: 0.85;
        }

        .preview-card-body {
            padding: 24px;
        }

        .preview-card-body p {
            font-size: 14px;
            color: var(--text-muted);
            margin-bottom: 16px;
        }

        .preview-btns {
            display: flex;
            gap: 10px;
        }

        .preview-btn-primary {
            padding: 8px 20px;
            border-radius: 6px;
            border: none;
            color: white;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            font-family: inherit;
        }

        .preview-btn-secondary {
            padding: 8px 20px;
            border-radius: 6px;
            border: 2px solid;
            background: transparent;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            font-family: inherit;
        }

        .preview-tags {
            display: flex;
            gap: 6px;
            margin-top: 16px;
        }

        .preview-tag {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
        }

        /* Contrast Checker */
        .contrast-section {
            margin-bottom: 32px;
        }

        .contrast-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 12px;
        }

        .contrast-pair {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: var(--radius-card);
            padding: 16px;
        }

        .contrast-demo {
            padding: 12px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            text-align: center;
            margin-bottom: 10px;
        }

        .contrast-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 12px;
        }

        .contrast-ratio {
            font-weight: 700;
        }

        .contrast-badges {
            display: flex;
            gap: 4px;
        }

        .contrast-badge {
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 700;
        }

        .contrast-badge.pass { background: var(--success); color: white; }
        .contrast-badge.fail { background: var(--error); color: white; }

        /* Export Section */
        .export-section {
            margin-bottom: 32px;
        }

        .export-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }

        .export-tab {
            background: var(--card);
            border: 1px solid var(--border);
            color: var(--text-muted);
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: all var(--transition);
            font-family: inherit;
        }

        .export-tab:hover { border-color: var(--accent); color: var(--text); }
        .export-tab.active { background: var(--accent); border-color: var(--accent); color: white; }

        .export-code {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: var(--radius-card);
            padding: 20px;
            font-family: 'SF Mono', 'Fira Code', 'Consolas', monospace;
            font-size: 13px;
            line-height: 1.7;
            overflow-x: auto;
            white-space: pre;
            color: var(--text);
            position: relative;
        }

        .export-copy-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            background: var(--border);
            border: none;
            color: var(--text-muted);
            padding: 6px 14px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-family: inherit;
            transition: all var(--transition);
        }

        .export-copy-btn:hover { background: var(--accent); color: white; }

        /* Saved Palettes */
        .saved-section {
            margin-bottom: 32px;
        }

        .saved-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 12px;
        }

        .saved-palette {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: var(--radius-card);
            overflow: hidden;
            cursor: pointer;
            transition: all var(--transition);
        }

        .saved-palette:hover { border-color: var(--accent); transform: translateY(-2px); }

        .saved-colors {
            display: flex;
            height: 50px;
        }

        .saved-colors div { flex: 1; }

        .saved-meta {
            padding: 10px 14px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .saved-meta span {
            font-size: 12px;
            color: var(--text-muted);
        }

        .saved-delete {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 14px;
            transition: color var(--transition);
            padding: 4px;
        }

        .saved-delete:hover { color: var(--error); }

        .empty-saved {
            color: var(--text-muted);
            font-size: 14px;
            text-align: center;
            padding: 24px;
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: var(--radius-card);
        }

        .save-btn {
            background: var(--card);
            border: 1px solid var(--border);
            color: var(--text);
            padding: 10px 24px;
            border-radius: var(--radius-input);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition);
            font-family: inherit;
            margin-bottom: 16px;
        }

        .save-btn:hover { border-color: var(--accent); color: var(--accent); }

        /* Footer */
        .footer {
            border-top: 1px solid var(--border);
            padding: 24px;
            text-align: center;
            color: var(--text-muted);
            font-size: 13px;
        }

        .footer a {
            color: var(--accent);
            text-decoration: none;
        }

        .footer a:hover { text-decoration: underline; }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 24px;
            right: 24px;
            background: var(--card);
            border: 1px solid var(--border);
            padding: 14px 24px;
            border-radius: var(--radius-input);
            font-size: 14px;
            color: var(--text);
            z-index: 1000;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s ease;
            pointer-events: none;
        }

        .toast.show { opacity: 1; transform: translateY(0); }

        /* Responsive */
        @media (max-width: 640px) {
            .hero h1 { font-size: 26px; }
            .header-inner { flex-direction: column; gap: 12px; }
            .swatch-info { padding: 8px; }
            .swatch-hex { font-size: 12px; }
            .swatch-formats { display: none; }
        }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg); }
        ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #333; }
    </style>
</head>
<body>

<header class="header">
    <div class="header-inner">
        <a href="https://nextool.app" class="logo" aria-label="NexTool Home">
            <div class="logo-icon">C</div>
            <div class="logo-text">Chroma<span>Kit</span></div>
        </a>
        <div class="badge">Free Tool &middot; No Sign-up</div>
    </div>
</header>

<main class="main">
    <div class="hero">
        <h1>Color Palette Generator</h1>
        <p>Generate harmonious color palettes using color theory. Lock colors, check contrast, export for your project.</p>
        <div class="shortcut-hint">Press <kbd>Space</kbd> to generate a new palette</div>
    </div>

    <div class="controls">
        <button class="mode-btn active" data-mode="analogous" onclick="setMode('analogous')">Analogous</button>
        <button class="mode-btn" data-mode="complementary" onclick="setMode('complementary')">Complementary</button>
        <button class="mode-btn" data-mode="triadic" onclick="setMode('triadic')">Triadic</button>
        <button class="mode-btn" data-mode="monochromatic" onclick="setMode('monochromatic')">Monochromatic</button>
        <button class="mode-btn" data-mode="split" onclick="setMode('split')">Split-Comp</button>
        <button class="generate-btn" onclick="generate()">Generate</button>
    </div>

    <div class="palette-container" id="paletteContainer"></div>

    <!-- Preview Card -->
    <div class="preview-section">
        <h3 class="section-title">Live Preview</h3>
        <div class="preview-card" id="previewCard">
            <div class="preview-card-header" id="previewHeader">
                <h4>Card Title</h4>
                <p>Subtitle text for the card preview</p>
            </div>
            <div class="preview-card-body">
                <p>This preview shows how your palette looks on a real UI component. Click colors to lock them, then regenerate.</p>
                <div class="preview-btns">
                    <button class="preview-btn-primary" id="previewBtnPrimary">Primary Action</button>
                    <button class="preview-btn-secondary" id="previewBtnSecondary">Secondary</button>
                </div>
                <div class="preview-tags" id="previewTags">
                    <span class="preview-tag" id="previewTag1">Tag One</span>
                    <span class="preview-tag" id="previewTag2">Tag Two</span>
                    <span class="preview-tag" id="previewTag3">Tag Three</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Contrast Checker -->
    <div class="contrast-section">
        <h3 class="section-title">Contrast Checker (WCAG)</h3>
        <div class="contrast-grid" id="contrastGrid"></div>
    </div>

    <!-- Export -->
    <div class="export-section">
        <h3 class="section-title">Export Palette</h3>
        <div class="export-tabs">
            <button class="export-tab active" onclick="setExport('css')">CSS Variables</button>
            <button class="export-tab" onclick="setExport('tailwind')">Tailwind</button>
            <button class="export-tab" onclick="setExport('scss')">SCSS</button>
        </div>
        <div class="export-code" id="exportCode">
            <button class="export-copy-btn" onclick="copyExport()">Copy</button>
            <span id="exportContent"></span>
        </div>
    </div>

    <!-- Save -->
    <div class="saved-section">
        <h3 class="section-title">Saved Palettes</h3>
        <button class="save-btn" onclick="savePalette()">Save Current Palette</button>
        <div id="savedList"></div>
    </div>
</main>

<footer class="footer">
    Part of <a href="https://christian140903-sudo.github.io/devtoolkit/">DevToolkit</a> by <a href="https://nextool.app">NexTool</a> &middot; nextool.app
</footer>

<div class="toast" id="toast"></div>

<script>
    let currentMode = 'analogous';
    let currentExport = 'css';
    let palette = [];
    let locked = [false, false, false, false, false];

    // --- Color Utilities ---
    function hslToHex(h, s, l) {
        h = ((h % 360) + 360) % 360;
        s /= 100; l /= 100;
        const c = (1 - Math.abs(2 * l - 1)) * s;
        const x = c * (1 - Math.abs((h / 60) % 2 - 1));
        const m = l - c / 2;
        let r, g, b;
        if (h < 60) { r = c; g = x; b = 0; }
        else if (h < 120) { r = x; g = c; b = 0; }
        else if (h < 180) { r = 0; g = c; b = x; }
        else if (h < 240) { r = 0; g = x; b = c; }
        else if (h < 300) { r = x; g = 0; b = c; }
        else { r = c; g = 0; b = x; }
        const toHex = v => Math.round((v + m) * 255).toString(16).padStart(2, '0');
        return '#' + toHex(r) + toHex(g) + toHex(b);
    }

    function hexToHsl(hex) {
        let r = parseInt(hex.slice(1, 3), 16) / 255;
        let g = parseInt(hex.slice(3, 5), 16) / 255;
        let b = parseInt(hex.slice(5, 7), 16) / 255;
        const max = Math.max(r, g, b), min = Math.min(r, g, b);
        let h, s, l = (max + min) / 2;
        if (max === min) { h = s = 0; }
        else {
            const d = max - min;
            s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
            switch (max) {
                case r: h = ((g - b) / d + (g < b ? 6 : 0)) / 6; break;
                case g: h = ((b - r) / d + 2) / 6; break;
                case b: h = ((r - g) / d + 4) / 6; break;
            }
        }
        return [Math.round(h * 360), Math.round(s * 100), Math.round(l * 100)];
    }

    function hexToRgb(hex) {
        return [parseInt(hex.slice(1, 3), 16), parseInt(hex.slice(3, 5), 16), parseInt(hex.slice(5, 7), 16)];
    }

    function luminance(r, g, b) {
        const [rs, gs, bs] = [r, g, b].map(v => {
            v /= 255;
            return v <= 0.03928 ? v / 12.92 : Math.pow((v + 0.055) / 1.055, 2.4);
        });
        return 0.2126 * rs + 0.7152 * gs + 0.0722 * bs;
    }

    function contrastRatio(hex1, hex2) {
        const [r1, g1, b1] = hexToRgb(hex1);
        const [r2, g2, b2] = hexToRgb(hex2);
        const l1 = luminance(r1, g1, b1);
        const l2 = luminance(r2, g2, b2);
        const lighter = Math.max(l1, l2);
        const darker = Math.min(l1, l2);
        return (lighter + 0.05) / (darker + 0.05);
    }

    function isLight(hex) {
        const [r, g, b] = hexToRgb(hex);
        return luminance(r, g, b) > 0.179;
    }

    function rand(min, max) { return Math.floor(Math.random() * (max - min + 1)) + min; }

    // --- Palette Generation ---
    function generatePalette() {
        const baseH = rand(0, 359);
        const baseS = rand(55, 85);
        const baseL = rand(40, 60);
        let colors = [];

        switch (currentMode) {
            case 'analogous':
                for (let i = -2; i <= 2; i++) {
                    colors.push(hslToHex(baseH + i * 25, baseS + rand(-10, 10), baseL + i * 5));
                }
                break;
            case 'complementary':
                colors.push(hslToHex(baseH, baseS, baseL));
                colors.push(hslToHex(baseH, baseS - 15, baseL + 15));
                colors.push(hslToHex(baseH + 180, baseS, baseL));
                colors.push(hslToHex(baseH + 180, baseS - 15, baseL - 10));
                colors.push(hslToHex(baseH + 180, baseS - 10, baseL + 15));
                break;
            case 'triadic':
                colors.push(hslToHex(baseH, baseS, baseL));
                colors.push(hslToHex(baseH, baseS - 20, baseL + 20));
                colors.push(hslToHex(baseH + 120, baseS, baseL));
                colors.push(hslToHex(baseH + 240, baseS, baseL));
                colors.push(hslToHex(baseH + 240, baseS - 20, baseL + 20));
                break;
            case 'monochromatic':
                for (let i = 0; i < 5; i++) {
                    colors.push(hslToHex(baseH, baseS + rand(-8, 8), 25 + i * 13));
                }
                break;
            case 'split':
                colors.push(hslToHex(baseH, baseS, baseL));
                colors.push(hslToHex(baseH, baseS - 20, baseL + 20));
                colors.push(hslToHex(baseH + 150, baseS, baseL));
                colors.push(hslToHex(baseH + 210, baseS, baseL));
                colors.push(hslToHex(baseH + 210, baseS - 15, baseL + 15));
                break;
        }

        for (let i = 0; i < 5; i++) {
            if (!locked[i]) {
                palette[i] = colors[i];
            }
        }

        updateURL();
        render();
    }

    function generate() { generatePalette(); }

    function setMode(mode) {
        currentMode = mode;
        document.querySelectorAll('.mode-btn').forEach(b => b.classList.toggle('active', b.dataset.mode === mode));
        generatePalette();
    }

    function toggleLock(i) {
        locked[i] = !locked[i];
        render();
    }

    // --- Rendering ---
    function render() {
        renderSwatches();
        renderPreview();
        renderContrast();
        renderExport();
        renderSaved();
    }

    function renderSwatches() {
        const container = document.getElementById('paletteContainer');
        container.innerHTML = palette.map((hex, i) => {
            const [r, g, b] = hexToRgb(hex);
            const [h, s, l] = hexToHsl(hex);
            const light = isLight(hex);
            return `<div class="color-swatch ${locked[i] ? 'locked' : ''}" onclick="toggleLock(${i})">
                <div class="swatch-color" style="background:${hex}">
                    <div class="lock-icon" style="color:${light ? '#000' : '#fff'}">${locked[i] ? '&#128274;' : '&#128275;'}</div>
                </div>
                <div class="swatch-info">
                    <div class="swatch-hex">${hex.toUpperCase()}</div>
                    <div class="swatch-formats">
                        <span>rgb(${r}, ${g}, ${b})</span>
                        <span>hsl(${h}, ${s}%, ${l}%)</span>
                    </div>
                    <button class="swatch-copy" onclick="event.stopPropagation();copyColor('${hex.toUpperCase()}')">Copy HEX</button>
                </div>
            </div>`;
        }).join('');
    }

    function renderPreview() {
        const header = document.getElementById('previewHeader');
        header.style.background = `linear-gradient(135deg, ${palette[0]}, ${palette[2]})`;

        const btnP = document.getElementById('previewBtnPrimary');
        btnP.style.background = palette[2];
        btnP.style.color = isLight(palette[2]) ? '#000' : '#fff';

        const btnS = document.getElementById('previewBtnSecondary');
        btnS.style.borderColor = palette[3];
        btnS.style.color = palette[3];

        const tags = [palette[1], palette[3], palette[4]];
        for (let i = 0; i < 3; i++) {
            const tag = document.getElementById('previewTag' + (i + 1));
            tag.style.background = tags[i] + '22';
            tag.style.color = tags[i];
        }
    }

    function renderContrast() {
        const grid = document.getElementById('contrastGrid');
        const pairs = [
            [0, 4], [1, 3], [0, 2], [2, 4], [1, 4]
        ];

        grid.innerHTML = pairs.map(([a, b]) => {
            const ratio = contrastRatio(palette[a], palette[b]);
            const aa = ratio >= 4.5;
            const aaa = ratio >= 7;
            const aaLarge = ratio >= 3;
            return `<div class="contrast-pair">
                <div class="contrast-demo" style="background:${palette[a]};color:${palette[b]}">
                    Sample Text Aa
                </div>
                <div class="contrast-info">
                    <span class="contrast-ratio">${ratio.toFixed(2)}:1</span>
                    <div class="contrast-badges">
                        <span class="contrast-badge ${aaLarge ? 'pass' : 'fail'}">AA-L</span>
                        <span class="contrast-badge ${aa ? 'pass' : 'fail'}">AA</span>
                        <span class="contrast-badge ${aaa ? 'pass' : 'fail'}">AAA</span>
                    </div>
                </div>
            </div>`;
        }).join('');
    }

    function renderExport() {
        const names = ['primary', 'secondary', 'accent', 'highlight', 'muted'];
        let code = '';

        if (currentExport === 'css') {
            code = ':root {\n';
            palette.forEach((hex, i) => {
                const [r, g, b] = hexToRgb(hex);
                code += `  --color-${names[i]}: ${hex};\n`;
                code += `  --color-${names[i]}-rgb: ${r}, ${g}, ${b};\n`;
            });
            code += '}';
        } else if (currentExport === 'tailwind') {
            code = `module.exports = {\n  theme: {\n    extend: {\n      colors: {\n`;
            palette.forEach((hex, i) => {
                code += `        '${names[i]}': '${hex}',\n`;
            });
            code += `      },\n    },\n  },\n};`;
        } else if (currentExport === 'scss') {
            palette.forEach((hex, i) => {
                code += `$color-${names[i]}: ${hex};\n`;
            });
            code += '\n$palette: (\n';
            palette.forEach((hex, i) => {
                code += `  '${names[i]}': $color-${names[i]}${i < 4 ? ',' : ''}\n`;
            });
            code += ');';
        }

        document.getElementById('exportContent').textContent = code;
    }

    function setExport(type) {
        currentExport = type;
        document.querySelectorAll('.export-tab').forEach(t => t.classList.toggle('active', t.textContent.toLowerCase().includes(type)));
        renderExport();
    }

    function copyExport() {
        const code = document.getElementById('exportContent').textContent;
        navigator.clipboard.writeText(code).then(() => showToast('Code copied to clipboard'));
    }

    function copyColor(hex) {
        navigator.clipboard.writeText(hex).then(() => showToast('Copied ' + hex));
    }

    // --- Save / Load ---
    function savePalette() {
        const saved = JSON.parse(localStorage.getItem('chromakit-palettes') || '[]');
        saved.unshift({ colors: [...palette], mode: currentMode, date: new Date().toLocaleDateString() });
        if (saved.length > 20) saved.pop();
        localStorage.setItem('chromakit-palettes', JSON.stringify(saved));
        showToast('Palette saved');
        renderSaved();
    }

    function loadPalette(index) {
        const saved = JSON.parse(localStorage.getItem('chromakit-palettes') || '[]');
        if (saved[index]) {
            palette = [...saved[index].colors];
            locked = [false, false, false, false, false];
            updateURL();
            render();
            showToast('Palette loaded');
        }
    }

    function deletePalette(index, e) {
        e.stopPropagation();
        const saved = JSON.parse(localStorage.getItem('chromakit-palettes') || '[]');
        saved.splice(index, 1);
        localStorage.setItem('chromakit-palettes', JSON.stringify(saved));
        renderSaved();
        showToast('Palette deleted');
    }

    function renderSaved() {
        const saved = JSON.parse(localStorage.getItem('chromakit-palettes') || '[]');
        const container = document.getElementById('savedList');

        if (saved.length === 0) {
            container.innerHTML = '<div class="empty-saved">No saved palettes yet. Click "Save Current Palette" to save one.</div>';
            return;
        }

        container.innerHTML = '<div class="saved-list">' + saved.map((p, i) => `
            <div class="saved-palette" onclick="loadPalette(${i})">
                <div class="saved-colors">${p.colors.map(c => `<div style="background:${c}"></div>`).join('')}</div>
                <div class="saved-meta">
                    <span>${p.mode} &middot; ${p.date}</span>
                    <button class="saved-delete" onclick="deletePalette(${i}, event)" aria-label="Delete palette">&#10005;</button>
                </div>
            </div>
        `).join('') + '</div>';
    }

    // --- URL Share ---
    function updateURL() {
        const hash = palette.map(c => c.slice(1)).join('-');
        history.replaceState(null, '', '#' + hash);
    }

    function loadFromURL() {
        const hash = location.hash.slice(1);
        if (hash) {
            const colors = hash.split('-').map(c => '#' + c);
            if (colors.length === 5 && colors.every(c => /^#[0-9a-fA-F]{6}$/.test(c))) {
                palette = colors;
                return true;
            }
        }
        return false;
    }

    // --- Keyboard ---
    document.addEventListener('keydown', (e) => {
        if (e.code === 'Space' && e.target.tagName !== 'INPUT' && e.target.tagName !== 'TEXTAREA') {
            e.preventDefault();
            generate();
        }
    });

    // --- Toast ---
    function showToast(msg) {
        const toast = document.getElementById('toast');
        toast.textContent = msg;
        toast.classList.add('show');
        setTimeout(() => toast.classList.remove('show'), 2500);
    }

    // --- Init ---
    if (!loadFromURL()) {
        palette = ['#6366f1', '#8b5cf6', '#a855f7', '#ec4899', '#f43f5e'];
        generatePalette();
    } else {
        render();
    }
</script>
</body>
</html>